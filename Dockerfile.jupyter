# Use the same base as the app for consistency
FROM python:3.11-slim-bookworm

# Install uv
COPY --from=ghcr.io/astral-sh/uv:latest /uv /bin/uv

WORKDIR /app

# Copy dependency definition
COPY pyproject.toml .

# Install project dependencies + JupyterLab
# We add jupyterlab dynamically here so it doesn't clutter the main app's pyproject.toml
RUN uv pip install --system -r pyproject.toml && \
    uv pip install --system jupyterlab

# Expose the requested port
EXPOSE 7799

# The command is handled by docker-compose, but this is a fallback
CMD ["jupyter", "lab", "--ip=0.0.0.0", "--port=7799", "--allow-root"]